% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_builder.R
\name{.gcv_select_lambda}
\alias{.gcv_select_lambda}
\title{Select optimal lambda using Generalized Cross-Validation}
\usage{
.gcv_select_lambda(W, y, lambda_seq = NULL, return_all = FALSE)
}
\arguments{
\item{W}{Matrix of word embeddings (rows = words, cols = dimensions)}

\item{y}{Vector of target scores}

\item{lambda_seq}{Sequence of lambda values to evaluate (default: logarithmic sequence)}

\item{return_all}{If TRUE, return GCV values for all lambdas (for diagnostics)}
}
\value{
If return_all = FALSE: optimal lambda value
        If return_all = TRUE: list with optimal_lambda, lambda_seq, gcv_values, df_values
}
\description{
Uses GCV (Golub et al., 1979) to select the optimal regularization parameter
for ridge regression. GCV approximates leave-one-out cross-validation with a
closed-form solution, making it computationally efficient.

Based on ORF 525 (Jianqing Fan): For ridge regression with smoother matrix
\eqn{S = W(W'W + \lambda I)^{-1} W'}{S = W(W'W + lambda*I)^-1 W'},
the GCV criterion is:

\deqn{GCV(\lambda) = \frac{n^{-1} ||y - S y||^2}{(1 - tr(S)/n)^2}}{GCV(lambda) = (RSS/n) / (1 - tr(S)/n)^2}

The effective degrees of freedom is
\eqn{tr(S) = \sum_j d_j^2 / (d_j^2 + \lambda)}{tr(S) = sum(d_j^2 / (d_j^2 + lambda))}
where \eqn{d_j} are singular values of \eqn{W}.
}
\references{
Golub, G. H., Heath, M., & Wahba, G. (1979). Generalized cross-validation as a
method for choosing a good ridge parameter. Technometrics, 21(2), 215-223.
}
\keyword{internal}
