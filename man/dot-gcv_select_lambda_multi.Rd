% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/03_builder.R
\name{.gcv_select_lambda_multi}
\alias{.gcv_select_lambda_multi}
\title{Select optimal lambda using Generalized Cross-Validation}
\usage{
.gcv_select_lambda_multi(
  dictionary,
  embeddings_path,
  dimensions = NULL,
  lambda_seq = NULL,
  aggregate = c("median", "mean", "min", "max", "none"),
  verbose = TRUE
)
}
\arguments{
\item{dictionary}{Data frame with 'word' column and dimension score columns}

\item{embeddings_path}{Path to word embeddings file}

\item{dimensions}{Character vector of dimension names to analyze. If NULL,
uses all numeric columns except 'word'.}

\item{lambda_seq}{Numeric vector of lambda values to evaluate. If NULL, uses
a logarithmic sequence from 1e-4 to 1e4.}

\item{aggregate}{How to combine optimal lambdas across dimensions:
"median" (default), "mean", "min", "max", or "none" (return all)}

\item{verbose}{Print progress messages}
}
\value{
If aggregate != "none": single optimal lambda value
        If aggregate = "none": named list with optimal lambda per dimension
        and diagnostic data
}
\description{
Uses GCV (Golub et al., 1979) to select the optimal regularization parameter
for ridge regression. GCV approximates leave-one-out cross-validation using
a closed-form solution based on the smoother matrix trace.

For ridge regression with smoother matrix
\eqn{S = W(W'W + \lambda I)^{-1} W'}{S = W(W'W + lambda*I)^-1 W'},
the GCV criterion is:

\deqn{GCV(\lambda) = \frac{n^{-1} ||y - S y||^2}{(1 - tr(S)/n)^2}}{GCV(lambda) = (RSS/n) / (1 - tr(S)/n)^2}

The effective degrees of freedom is
\eqn{tr(S) = \sum_j d_j^2 / (d_j^2 + \lambda)}{tr(S) = sum(d_j^2 / (d_j^2 + lambda))}
where \eqn{d_j} are singular values of \eqn{W}.
}
\references{
Golub, G. H., Heath, M., & Wahba, G. (1979). Generalized cross-validation as
a method for choosing a good ridge parameter. Technometrics, 21(2), 215-223.

Fan, J. (2026). ORF 525: Statistical Foundations of Data Science. Princeton University.
}
\keyword{internal}
